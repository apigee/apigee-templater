name: AI-API-v1
type: proxy
description: API proxy AI-API-v1
endpoints:
  - name: gemini
    basePath: /v1/gemini
    routes:
      - name: default
        target: gemini
    flows:
      - name: PreFlow
        mode: Request
        condition: ""
        steps:
          - name: VA-VerifyKey
          - name: AM-RemoveKey
    faultRules: []
  - name: llama
    basePath: /v1/llama
    routes:
      - name: default
        target: llama
    flows:
      - name: PreFlow
        mode: Request
        condition: ""
        steps:
          - name: VA-VerifyKey
          - name: AM-RemoveKey
    faultRules: []
  - name: mistral
    basePath: /v1/mistral
    routes:
      - name: default
        target: mistral
    flows:
      - name: PreFlow
        mode: Request
        condition: ""
        steps:
          - name: VA-VerifyKey
          - name: AM-RemoveKey
    faultRules: []
targets:
  - name: gemini
    url: https://europe-west1-aiplatform.googleapis.com/v1/projects/{organization.name}/locations/europe-west1/endpoints/openapi/chat/completions
    flows: []
    faultRules: []
    httpTargetConnection:
      Properties: {}
      URL:
        _text: https://europe-west1-aiplatform.googleapis.com/v1/projects/{organization.name}/locations/europe-west1/endpoints/openapi/chat/completions
      Authentication:
        GoogleAccessToken:
          Scopes:
            Scope:
              _text: https://www.googleapis.com/auth/cloud-platform
  - name: llama
    url: https://us-east5-aiplatform.googleapis.com/v1/projects/{organization.name}/locations/us-east5/endpoints/openapi/chat/completions
    flows: []
    faultRules: []
    httpTargetConnection:
      Properties: {}
      URL:
        _text: https://us-east5-aiplatform.googleapis.com/v1/projects/{organization.name}/locations/us-east5/endpoints/openapi/chat/completions
      Authentication:
        GoogleAccessToken:
          Scopes:
            Scope:
              _text: https://www.googleapis.com/auth/cloud-platform
  - name: mistral
    url: https://europe-west4-aiplatform.googleapis.com/v1/projects/{organization.name}/locations/europe-west4/publishers/mistralai/models/mistral-large-2411:rawPredict
    flows: []
    faultRules: []
    httpTargetConnection:
      Properties: {}
      URL:
        _text: https://europe-west4-aiplatform.googleapis.com/v1/projects/{organization.name}/locations/europe-west4/publishers/mistralai/models/mistral-large-2411:rawPredict
      Authentication:
        GoogleAccessToken:
          Scopes:
            Scope:
              _text: https://www.googleapis.com/auth/cloud-platform
policies:
  - name: AM-RemoveKey
    type: AssignMessage
    content:
      AssignMessage:
        _attributes:
          continueOnError: "false"
          enabled: "true"
          name: AM-RemoveKey
        DisplayName:
          _text: AM-RemoveKey
        Properties: {}
        Remove:
          Headers:
            Header:
              _attributes:
                name: x-api-key
        IgnoreUnresolvedVariables:
          _text: "true"
        AssignTo:
          _attributes:
            createNew: "false"
            transport: http
            type: request
  - name: VA-VerifyKey
    type: VerifyAPIKey
    content:
      VerifyAPIKey:
        _attributes:
          continueOnError: "false"
          enabled: "true"
          name: VA-VerifyKey
        DisplayName:
          _text: VA-VerifyKey
        Properties: {}
        APIKey:
          _attributes:
            ref: request.header.x-api-key
resources: []
